При объединении исходных файлов (выгруженных из ДОКи присоединенных файлов
с именем Номер ДОКИ+индекс) в один xml в случае, когда все исходные файлы
разных документов лежат в одном месте, не рассортированные по каталогам,
получаются некорректные файлы в нечитаемой кодировке (это случается, когда
первый файл - Excel). Если файлы, которые относятся к одному документу 
положить в каталог, то получится все ок, и этой ошибки не возникает.

Необходимо при поиске главного документа добавить условие проверки, чтобы главным файлом был документ word.
Файл excel первым (главным) документом быть не могут

Правильный порядок следования:
875771-2.doc - основной документ
875771-1.xls
875771-3.xls

880964-3.doc - основной документ
880964-1.xls
880964-2.xls
880964-4.xlsx

890105-2.docx - основной документ
890105-1.xls


